(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{407:function(a,s,e){"use strict";e.r(s);var t=e(56),n=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[a._v("#")]),a._v(" Docker")]),a._v(" "),e("h2",{attrs:{id:"build-containers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#build-containers"}},[a._v("#")]),a._v(" Build containers")]),a._v(" "),e("h3",{attrs:{id:"web"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#web"}},[a._v("#")]),a._v(" web")]),a._v(" "),e("p",[a._v("The "),e("code",[a._v("web")]),a._v(" container comes with nginx and php8.1-fpm.")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build -t web "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -f .docker/web/Dockerfile "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --build-arg "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"NOVA_USERNAME="')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --build-arg "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"NOVA_PASSWORD="')]),a._v("\n")])])]),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run --name web "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -p "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("80")]),a._v(":80 "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -v "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v('/.docker/web/app.conf:/etc/nginx/conf.d/app.conf"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -v "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v('/.env:/app/.env"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  web\n")])])]),e("h3",{attrs:{id:"queue"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#queue"}},[a._v("#")]),a._v(" queue")]),a._v(" "),e("p",[a._v("The "),e("code",[a._v("queue")]),a._v(" container will run the "),e("code",[a._v("artisan queue:work")]),a._v(" command. An additional "),e("code",[a._v("QUEUE")]),a._v(" environment variable can be passed to configure the queue name.")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build -t queue "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -f .docker/queue/Dockerfile "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --build-arg "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"NOVA_USERNAME="')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --build-arg "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"NOVA_PASSWORD="')]),a._v("\n")])])]),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run --name queue "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -v "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v('/.env:/app/.env"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -e "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("QUEUE")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("default "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  queue\n")])])]),e("h3",{attrs:{id:"scheduler"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#scheduler"}},[a._v("#")]),a._v(" scheduler")]),a._v(" "),e("p",[a._v("The "),e("code",[a._v("scheduler")]),a._v(" container will execute the "),e("code",[a._v("artisan schedule:run")]),a._v(" command every 60 seconds. This replaces a cron-based setup.")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build -t scheduler "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -f .docker/scheduler/Dockerfile "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --build-arg "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"NOVA_USERNAME="')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --build-arg "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"NOVA_PASSWORD="')]),a._v("\n")])])]),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run --name scheduler "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -v "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),e("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v('/.env:/app/.env"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  scheduler\n")])])]),e("h2",{attrs:{id:"docker-compose"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[a._v("#")]),a._v(" Docker Compose")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("COMPOSE_PROJECT_NAME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("skeleton "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker-compose")]),a._v(" up\n")])])]),e("h3",{attrs:{id:"local-docker-compose-yml"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#local-docker-compose-yml"}},[a._v("#")]),a._v(" Local docker-compose.yml")]),a._v(" "),e("p",[a._v("The local docker compose file uses the included Dockerfiles to build and spin up containers.")]),a._v(" "),e("p",[a._v("Note: You will need to specify environment variables for Laravel Nova and the database container. See "),e("a",{attrs:{href:"/.docker/.env.example"}},[a._v("the Docker .env.example")]),a._v(" file for more information.")]),a._v(" "),e("h4",{attrs:{id:"start-docker-stack"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#start-docker-stack"}},[a._v("#")]),a._v(" Start docker stack")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("COMPOSE_PROJECT_NAME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("skeleton "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker-compose")]),a._v(" up\n")])])]),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("COMPOSE_PROJECT_NAME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("skeleton "),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker-compose")]),a._v(" up --build\n")])])]),e("h4",{attrs:{id:"migrate-database"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#migrate-database"}},[a._v("#")]),a._v(" Migrate database")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" -it web php artisan migrate\n")])])]),e("p",[a._v("You should be able to access the skeleton at "),e("a",{attrs:{href:"http://localhost:8000",target:"_blank",rel:"noopener noreferrer"}},[a._v("localhost:8000"),e("OutboundLink")],1),a._v(".")]),a._v(" "),e("p",[a._v("<< .docker/docker-compose.yml")])])}),[],!1,null,null,null);s.default=n.exports}}]);